{"version":3,"file":"index.js","sources":["../src/utils.js","../src/condition.js","../src/timeshift.js","../src/selector.js","../src/alias.js","../src/function.js","../src/part.js","../src/decoder.js","../src/serializer.js","../src/query.js","../src/index.js"],"sourcesContent":["/**\n * Miscellaneous utilities\n */\n\nexport function clone(obj) {\n  var proto = Object.getPrototypeOf(obj),\n      c = Object.create(proto);\n  Object.assign(c, obj);\n  return c;\n}\n","export default class Condition {\n\n  static __schema = {\n    proto: Condition.prototype,\n    ref: {\n      args: [function(context) {\n        if (typeof context === 'object' &&\n            context.op !== void 0 &&\n            context.args !== void 0)\n          return Condition.__schema;\n        return null;\n      }]\n    }\n  };\n\n  constructor (op, ...args) {\n    this.op = op;\n    this.args = args;\n  }\n\n  and (other) {\n    return new Condition('and', this, other);\n  }\n\n  or (other) {\n    return new Condition('or', this, other);\n  }\n\n  toString() {\n    var tag, value, a, b;\n    switch (this.op) {\n    case ('eq'):\n      [tag, value] = this.args;\n      return `${this._encodeTag(tag)} = '${value}'`;\n    case ('neq'):\n      [tag, value] = this.args;\n      return `${this._encodeTag(tag)} != '${value}'`;\n    case ('present'):\n      [tag] = this.args;\n      return this._encodeTag(tag);\n    case ('and'):\n      [a, b] = this.args;\n      return `${a} AND ${b}`;\n    case ('or'):\n      [a, b] = this.args;\n      return `${a} OR ${b}`;\n    }\n    return '';\n  }\n\n  _encodeTag([ns, key]) {\n    return ns ? `${ns}:'${key}'` : `'${key}'`;\n  }\n}\n","export default class Timeshift {\n\n  static __schema = {\n    proto: Timeshift.prototype\n  };\n\n  constructor(offset) {\n    this.offset = offset;\n  }\n\n  toString() {\n    return `SHIFT BY ${this.offset}`;\n  }\n}\n","import {clone} from \"./utils.js\";\nimport Condition from \"./condition.js\";\nimport Timeshift from \"./timeshift.js\";\n\n\nconst ALL = {\n  toString: function() {\n    return 'ALL';\n  }\n};\n\n\nfunction isKeyword(part) {\n  return part === ALL;\n}\n\n\nexport default class Selector {\n\n  static __schema = {\n    proto: Selector.prototype,\n    ref: {\n      condition: Condition.__schema,\n      timeshift: Timeshift.__schema\n    }\n  };\n\n  constructor(collection, metric) {\n    if (Array.isArray(metric)) {\n      metric = metric.map(function (mpart) {\n        if (isKeyword(mpart)) return mpart;\n        return mpart.value ? mpart.value : mpart.toString();\n      });\n    } else if (typeof metric == 'string' && metric.toUpperCase() == 'ALL') {\n      metric = [ALL];\n    } else {\n      throw new Error(`Expected metric to be an Array, got '${metric}' instead`);\n    }\n    this.collection = collection;\n    this.metric = metric;\n  }\n\n  where(condition, operator) {\n    if (! condition instanceof Condition)\n      throw new Error(\"Invalid query condition\");\n    if (operator && this.condition) {\n      condition = this.condition[operator](condition);\n    }\n    var selector = clone(this);\n    selector.condition = condition;\n    return selector;\n  }\n\n  andWhere(condition) {\n    return this.where(condition, 'and');\n  }\n\n  orWhere(condition) {\n    return this.where(condition, 'or');\n  }\n\n  shiftBy(offset) {\n    var selector = clone(this),\n        timeshift = new Timeshift(offset);\n    selector.timeshift = timeshift;\n    return selector;\n  }\n\n  toString() {\n    var metric = this._encodeMetric(),\n        collection = this._encodeCollection(),\n        str = `${metric} FROM ${collection}`;\n    if (this.condition)\n      str += ' WHERE ' + this.condition;\n    if (this.timeshift)\n      str += ' ' +  this.timeshift.toString();\n    return str;\n  }\n\n  /**\n   * Internal methods\n   */\n\n  _encodeCollection() {\n    return `'${this.collection}'`;\n  }\n\n  _encodeMetric() {\n    return this.metric.map(function(part) {\n      if (isKeyword(part))\n        return part;\n      else\n        return `'${part}'`;\n    }).join('.');\n  }\n}\n","import {clone} from \"./utils.js\";\n\n\nexport default class Alias {\n\n  static __schema = {\n    proto: Alias.prototype\n  };\n\n  constructor(label) {\n    if (label !== void 0) this.label = label;\n    this.tags = [];\n  }\n\n  useLabel(label) {\n    var alias = clone(this);\n    alias.label = label;\n    return alias;\n  }\n  \n  prefixWith(prefix) {\n    var alias = clone(this);\n    alias.prefix = prefix;\n    return alias;\n  }\n\n  annotateWith(...tags) {\n    var alias = clone(this);\n    tags = tags.map(normalizeTag);\n    alias.tags = dedupTags(this.tags.concat(tags));\n    return alias;\n  }\n\n  toString() {\n    return `AS ${this._encode()}`;\n  }\n\n  _encode() {\n    var sections = this.prefix || [];\n    if (this.tags)\n      sections = sections.concat(this.tags);\n    if (this.label)\n      sections = sections.concat(this.label);\n    return sections.map(encodeSection).join('.');\n  }\n}\n\nfunction encodeName(name) {\n  if (name[0] != '$' &&\n      (name[0] != '\\'' ||\n       name[name.length - 1] != '\\'')) {\n    name = name.replace(/(['\\\\])/g, '\\$1');\n    return `'${name}'`;\n  }\n  return name;\n}\n\nfunction encodeSection(section) {\n  if (Array.isArray(section)) {\n    let [ns, name] = section;\n    if (ns)\n      return `\\$${ns}:${encodeName(name)}`;\n    else\n      return `\\$${encodeName(name)}`;\n  }\n  return encodeName(section);\n}\n\nfunction normalizeTag(tag) {\n  if (typeof tag === 'string') {\n    let m = tag.match(/^(([a-z]*):)?(.*)$/);\n    if (! m)\n      throw new Error(\"Invalid alias variable: \" + tag);\n    let ns = m[2],\n        name = m[3];\n    return [ns, name];\n  }\n  return tag;\n}\n\nfunction dedupTags(tags) {\n  return tags;\n}\n","export default class Function {\n\n  static __schema = {\n    proto: Function.prototype,\n    ref: {\n      args: [function(context) {\n        if (typeof context === 'object' &&\n            context.fun !== void 0 &&\n            context.args !== void 0)\n          return Function.__schema;\n        return null;\n      }]\n    }\n  };\n\n  constructor(fun, args) {\n    this.fun = fun;\n    this.args = args;\n    this._encodeArg = this._encodeArg.bind(this);\n  }\n\n  toString(vars) {\n    var args = this.args.map((a) => this._encodeArg(a, vars));\n    return `${this.fun}(${args.join(', ')})`;\n  }\n\n  _encodeArg(arg, vars) {\n    if (typeof arg === 'string' && arg[0] === '$') {\n      let varname = arg.slice(1);\n      arg = vars[varname];\n      if (arg === void 0)\n        throw new Error(`Variable ${varname} is not declared`);\n      if (typeof arg.toString === 'function')\n        // convert to string, but drop alias as we are in a nested query\n        arg = arg.toString(vars, {includeAlias: false});\n    } else if (typeof arg === 'object' && typeof arg.toString == 'function') {\n      arg = arg.toString(vars);\n    }\n    return '' + arg;\n  }\n}\n","import {clone} from \"./utils.js\";\nimport Selector from \"./selector.js\";\nimport Alias from \"./alias.js\";\nimport Function from \"./function.js\";\n\n\n// Selector methods that are exposed on part level\nconst SELECTOR_METHODS = [\n  'where',\n  'andWhere',\n  'orWhere',\n  'shiftBy'\n];\n\n\nexport default class Part {\n\n  static __schema = {\n    proto: Part.prototype,\n    ref: {\n      alias: Alias.__schema,\n      selector: Selector.__schema,\n      fn: Function.__schema\n    }\n  };\n\n  constructor(collection, metric) {\n    this.selector = new Selector(collection, metric);\n  }\n\n  apply(fun, args = []) {\n    var part = clone(this),\n        fargs = [this.fn || '$__selector'].concat(args),\n        fn = new Function(fun, fargs);\n    part.fn = fn;\n    return part;\n  }\n\n  nameBy(name) {\n    var part = clone(this);\n    part.name = name;\n    return part;\n  }\n\n  labelBy(label) {\n    var part = clone(this),\n        alias = part.alias ? part.alias.useLabel(label) : new Alias(label);\n    part.alias = alias;\n    return part;\n  }\n\n  prefixWith(prefix) {\n    var part = clone(this),\n        alias = this.alias || new Alias();\n    part.alias = alias.prefixWith(prefix);\n    return part;\n  }\n\n  annotateWith(...tags) {\n    var part = clone(this),\n        alias = this.alias || new Alias();\n    part.alias = alias.annotateWith(...tags);\n    return part;\n  }\n\n  exclude() {\n    if (this.excluded)\n      return this;\n\n    var part = clone(this);\n    part.excluded = true;\n    return part;\n  }\n\n  include() {\n    if (! this.hasOwnProperty('excluded'))\n      return this;\n\n    var part = clone(this);\n    delete part.excluded;\n    return part;\n  }\n\n  toString(vars, options = {includeAlias: true}) {\n    var str = '' + this.selector;\n    if (this.fn) {\n      vars = {...vars, '__selector': this.selector};\n      str = this.fn.toString(vars);\n    }\n    if (this.alias && options.includeAlias)\n      str += ' ' + this.alias.toString();\n    return str;\n  }\n\n  /**\n   * Internal methods\n   */\n\n  _updateSelector(method, ...args) {\n    var selector = this.selector[method](...args);\n    this.selector = selector;\n    return this;\n  }\n}\n\n\nSELECTOR_METHODS.forEach(function(method) {\n  Part.prototype[method] = function (...args) {\n    return this._updateSelector(method, ...args);\n  };\n});\n","import moment from \"moment\";\n\n\nfunction overlayConfidence(v1, v2) {\n  if (v1.length != v2.length) {\n    throw new Error('All arrays must be the same length');\n  }\n  for (let i = 0; i < v1.length; i++) {\n    v1[i] = v1[i] === void 0 ? v2[i] : Math.max(v1[i], v2[i]);\n  }\n}\n\n\nexport default class Decoder {\n\n  constructor(query, options) {\n    this.decode = (r) => decode(query, r, options);\n  };\n}\n\n\nfunction decode(query, resp, options = {}) {\n  var {s, t, d} = resp,\n      parts = query ? query.parts : [],\n      start = moment(s * 1000),\n      //matched = new Array(parts.length),\n      matched = {},\n      confidenceOverlay,\n      series;\n\n  // First pass is to decode name and eventually match values and confidence channels\n  Array.prototype.forEach.call(d, function({n, r, v}) {\n    var sections = decodeN(n),\n        idx = parseInt(sections.shift()),\n        channel = 'v',\n        increment = 0,\n        keyPrefix,\n        key;\n\n    if (options.applyConfidence) {\n      channel = sections.shift();\n      idx *= 2; // Because confidence duplicated number of parts in a query\n    }\n\n    // Confidence and value channels are matched on combination of query index and\n    // extra meta-data sections. On top of that we add increment, so we can match\n    // in a situation that there is multiple series coming with the same meta data.\n    // In that case they will be matched based on order of appearance.\n    keyPrefix = [idx].concat(sections, '').join('.');\n    key = keyPrefix + increment;\n    while (matched[key] && matched[key][channel]) {\n      increment += 1;\n      key = keyPrefix + increment;\n    }\n \n    if (! matched[key]) {\n      matched[key] = {sections, r,\n                      qpart: parts[idx]};\n    } else {\n      if (matched[key].r != r)\n        throw new Error(\"Values and confidence data came in different resolution\");\n    }\n\n    if (options.applyConfidence == 'aligned' && channel === 'c') {\n      if (! confidenceOverlay)\n        confidenceOverlay = new Array(v.length);\n      overlayConfidence(confidenceOverlay, v);\n      v = confidenceOverlay;\n    }\n\n    matched[key][channel] = v;\n  }, []);\n\n  // Second pass is to do actual decoding\n  series = Object.keys(matched).map(function(key) {\n    let {sections, qpart, r, v, c} = matched[key],\n        tagDefinitions = qpart.alias && qpart.alias.tags || [],\n        tags = {},\n        name;\n\n    if (! v)\n      throw new Error(\"Missing data channel in response to: \" + qpart);\n    \n    if (qpart.alias && qpart.alias.label) {\n      name = qpart.alias.label;\n    } else {\n      name = qpart.selector.toString();\n    }\n\n    for (let i = 0; i < tagDefinitions.length; i++) {\n      let tag = tagDefinitions[i];\n      tags[tagKey(tag)] = sections[i];\n    }\n\n    return {qpart, name, tags,\n            points: decodePoints(v, c, start.valueOf(), r)};\n  });\n  return {start, series};\n}\n\n\nfunction decodePoints(values, confidence, start, increment) {\n  return confidence?\n    decodeConfidencePoints(values, confidence, start, increment) :\n    decodeContinousPoints(values, start, increment);\n}\n\n\nfunction decodeContinousPoints(values, start, increment) {\n  var r = new Array(values.length);\n  for (var i = 0; i < values.length; i++) {\n    r[i] = [values[i], start + (i * increment)];\n  }\n  return r;\n}\n\n\nfunction decodeConfidencePoints(values, confidence, start, increment) {\n  var r = new Array();\n  for (var i = 0; i < values.length; i++) {\n    if (confidence[i] > 0) {\n      r.push([values[i], start + (i * increment)]);\n    }\n  }\n  return r;\n}\n\n\nfunction decodeN(n) {\n  return n.split('.').map(decodeNSection);\n}\n\n\nfunction decodeNSection(section) {\n  if (section[0] == \"'\" && section[section.length - 1] == \"'\") {\n    section = section.slice(1, -1).replace(/\\\\(.)/g, '$1');\n  }\n  return section;\n}\n\nfunction tagKey(tag) {\n  if (Array.isArray(tag)) {\n    if (tag[0])\n      return `${tag[0]}:${tag[1]}`;\n    return tag[1];\n  }\n  return tag;\n}\n","import moment from \"moment\";\n\n\nfunction objToJSON(obj, options) {\n  var schema = Object.getPrototypeOf(obj).constructor.__schema,\n      r = {},\n      n, j;\n\n  for (n of Object.getOwnPropertyNames(obj)) {\n    if (schema && schema.ignore && schema.ignore.indexOf(n) >= 0) {\n      continue;\n    }\n    j = anyToJSON(obj[n]);\n    if (j !== void 0)\n      r[n] = j;\n  }\n  return r;\n}\n\n\nfunction anyToJSON (obj) {\n  switch (typeof obj) {\n  case 'number':\n  case 'string':\n  case 'boolean':\n    return obj;\n  case 'function':\n    return undefined;\n  case 'object':\n    if (obj === null)\n      return undefined;\n    if (typeof obj.toJSON === 'function')\n      return obj.toJSON();\n    if (Array.isArray(obj))\n      return obj.map(anyToJSON);\n    return objToJSON(obj);\n  };\n  return undefined;\n}\n\n\nfunction objFromJSON (schema, json) {\n  var proto = schema.proto,\n      ref = schema.ref,\n      obj = Object.create(proto),\n      n, o;\n\n  Object.assign(obj, json);\n\n  for (n of Object.getOwnPropertyNames(obj)) {\n    if (ref && ref[n])\n      o = objFromRefedJSON(ref[n], json[n]);\n    else\n      o = json[n];\n    obj[n] = o;\n  };\n  return obj;\n}\n\n// Ref can be a schema, an array of refs or a function returning ref, or a class\n// identifier\nfunction objFromRefedJSON(ref, json) {\n  if (! ref)\n    return json;\n\n  if (typeof ref === 'function')\n    return objFromRefedJSON(ref(json), json);\n\n  if (Array.isArray(ref))\n    return Array.prototype.map.call(json, objFromRefedJSON.bind(null, ref[0]));\n\n  if (ref === \"moment\")\n    return moment(json);\n\n  if (ref === \"duration\")\n    return moment.duration(json);\n\n  return objFromJSON(ref, json);\n}\n\n\nvar Serializer = {\n  toJSON: objToJSON,\n  fromJSON: objFromJSON\n};\n\nexport default Serializer;\n","import moment from \"moment\";\n\nimport {clone} from \"./utils.js\";\nimport Condition from \"./condition.js\";\nimport Part from \"./part.js\";\nimport Decoder from \"./decoder.js\";\nimport Serializer from \"./serializer.js\";\n\n// Part methods that are exposed to Query top level api\nconst PART_METHODS = [\n  'where',\n  'andWhere',\n  'orWhere',\n  'apply',\n  'shiftBy',\n  'nameBy',\n  'labelBy',\n  'annotateWith',\n  'exclude',\n  'include'\n];\n\n\nclass AbortablePromise {\n\n  constructor(promise, abort) {\n    this.promise = promise;\n    if (abort) {\n      this.abort = abort;\n    } else if (promise.abort) {\n      this.abort = promise.abort.bind(promise);\n    } else {\n      throw new Error(\"Tried to initialise abort-able promise without abort handler\"); \n    }\n  }\n\n  then(onFulfilled, onRejected) {\n    return new AbortablePromise(this.promise.then(onFulfilled, onRejected),\n                                this.abort);\n  }\n\n  catch(onRejected) {\n    return new AbortablePromise(this.promise.catch(onRejected), this.abort);\n  }\n}\n\n\n/**\n * DalmatinerDB Query builder.\n *\n * It provides chainable api to programatically assemble dalmatiner queries\n */\nexport default class Query {\n\n  static __schema = {\n    proto: Query.prototype,\n    ref: {\n      parts: [Part.__schema],\n      beginning: 'moment',\n      ending: 'moment',\n      duration: 'duration'\n    },\n    ignore: ['vars']\n  };\n\n  constructor() {\n    this.parts = [];\n  }\n\n  /**\n   * Chain-able query generators\n   *\n   * Each one of them will generate new query\n   */\n  from(c) {\n    var query = clone(this);\n    query.collection = c.value ? c.value : c.toString();\n    return query;\n  }\n\n  select(m) {\n    if (! this.collection)\n      throw new Error(\"You need to set collection (from statement) before selecting metric\");\n\n    var query = clone(this),\n        part = new Part(this.collection, m);\n\n    query.parts = query.parts.concat(part);\n    return query;\n  }\n\n  selectAll() {\n    return this.select('ALL');\n  }\n\n  beginningAt(t) {\n    var query = clone(this);\n    query.beginning = moment(t);\n    return query;\n  }\n\n  endingAt(t) {\n    var query = clone(this);\n    query.ending = moment(t);\n    return query;\n  }\n\n  last(...args) {\n    var query = clone(this);\n    query.duration = moment.duration(...args);\n    query.beginning = null;\n    query.ending = null;\n    return query;\n  }\n\n  with(name, value) {\n    if (! this.vars) this.vars = {};\n    this.vars[name] = value;\n    return this;\n  }\n\n  /**\n   * Non chain-able utilities\n   */\n\n  request(options = {}) {\n    var settings = {data: {}},\n        query = clone(this),\n        parts = query.parts,\n        decoder = null;\n\n    parts = parts.map((part, idx) => {\n      return part.prefixWith(['' + idx]);\n    });\n    if (options.applyConfidence) {\n      parts = parts.reduce(function(acc, part) {\n        let prefix = part.alias.prefix,\n            vpart = part.prefixWith(prefix.concat('v')),\n            cpart = part.prefixWith(prefix.concat('c'))\n              .apply('confidence');\n        return acc.concat(vpart, cpart);\n      }, []);\n    }\n    query.parts = parts;\n    decoder = new Decoder(query, options),\n    settings.data.q = query.toString();\n\n    if (! options.url)\n      settings.url = 'http://localhost:8080'; // Default url\n\n    if (! (options.headers && options.headers.accept)) {\n      if (! settings.headers) {\n        settings.headers = {};\n      }\n      // TODO: add msgpack optional decoding, when msgpack-lite is reachable\n      settings.headers.accept = 'application/json';\n    }\n\n    Object.assign(settings, options);\n    return { settings, decoder };\n  }\n\n  exec(ajax, options) {\n    if (! ajax)\n      throw new Error(\"Missing ajax function\");\n    var { settings, decoder } = this.request(options);\n    return new AbortablePromise(ajax(settings))\n      .then(decoder.decode);\n  }\n\n  /**\n   * Reading methods\n   */\n\n  lastPart() {\n    var len = this.parts.length;\n    return this.parts[len - 1];\n  }\n\n  toString(vars) {\n    var parts = this._encodeParts(vars).join(', '),\n        range = this._encodeRange(),\n        str = 'SELECT ' + parts;\n    if (range)\n      str += ' ' + range;\n    return str;\n  }\n\n  toJSON() {\n    return Serializer.toJSON(this);\n  }\n\n  /**\n   * Internal methods\n   */\n\n  _updatePart(method, ...args) {\n    if (this.parts.length === -1) \n      throw new Error(\"You need to select something before doing any futher operations\");\n\n    var parts = this.parts.concat(),\n        lastIdx = parts.length - 1,\n        last = parts[lastIdx],\n        query = clone(this);\n\n    parts[lastIdx] = last[method](...args);\n    query.parts = parts;\n    return query;\n  }\n\n  _encodeTime(m) {\n    return m.utc().format('\"YYYY-MM-DD HH:mm:ss\"');\n  }\n\n  _encodeDuration() {\n    var inSecs = Math.max(Math.round(this.duration.asSeconds()), 1);\n\n    return inSecs + 's';\n  }\n\n  _encodeRange() {\n    if (this.ending && this.beginning) {\n      let start = this._encodeTime(this.beginning),\n          end = this._encodeTime(this.ending);\n      return `BETWEEN ${start} AND ${end}`;\n    } else if (this.ending && this.duration) {\n      let end = this._encodeTime(this.ending),\n          duration = this._encodeDuration();\n      return `BEFORE ${end} FOR ${duration}`;\n    } else if (this.beginning && this.duration) {\n      let start = this._encodeTime(this.beginning),\n          duration = this._encodeDuration();\n      return `AFTER ${start} FOR ${duration}`;\n    } else if (this.duration) {\n      return `LAST ${this._encodeDuration()}`;\n    }\n    return '';\n  }\n\n  _encodeParts(vars) {\n    var vs = this._defaultVars(),\n        encoded = [];\n    if (this.vars)\n      Object.assign(vs, this.vars);\n    if (vars)\n      Object.assign(vs, vars);\n\n    for (let part of this.parts){\n      if (! part.excluded)\n        encoded.push(part.toString(vs));\n    };\n    return encoded;\n  }\n\n  _defaultVars() {\n    var vars = {};\n    for (let part of this.parts) {\n      if (part.name)\n        vars[part.name] = part;\n    }\n    return vars;\n  }\n};\n\n\nPART_METHODS.forEach(function(method) {\n  Query.prototype[method] = function (...args) {\n    return this._updatePart(method, ...args);\n  };\n});\n","import Query from \"./query.js\";\nimport Condition from \"./condition.js\";\nimport Serializer from \"./serializer.js\";\n\n\nexport var query = new Query();\n\nexport function or(a, b) {\n  return new Condition('or', a, b);\n}\n\nexport function and(a, b) {\n  return new Condition('and', a, b);\n}\n\nexport function equals(a, b) {\n  return new Condition('eq', a, b);\n}\n\nexport function notEquals(a, b) {\n  return new Condition('neq', a, b);\n}\n\nexport function present(a) {\n  return new Condition('present', a);\n}\n\nexport function fromJSON(json) {\n  return Serializer.fromJSON(Query.__schema, json);\n}\n\n"],"names":["clone","obj","proto","Object","getPrototypeOf","c","create","assign","Condition","op","args","other","tag","value","a","b","_encodeTag","ns","key","__schema","prototype","context","Timeshift","offset","ALL","isKeyword","part","Selector","collection","metric","Array","isArray","map","mpart","toString","toUpperCase","Error","condition","operator","selector","where","timeshift","_encodeMetric","_encodeCollection","str","join","Alias","label","tags","alias","prefix","normalizeTag","dedupTags","concat","_encode","sections","encodeSection","encodeName","name","length","replace","section","m","match","Function","fun","_encodeArg","bind","vars","arg","varname","slice","includeAlias","SELECTOR_METHODS","Part","fargs","fn","useLabel","prefixWith","annotateWith","excluded","hasOwnProperty","options","method","forEach","_updateSelector","overlayConfidence","v1","v2","i","Math","max","Decoder","query","decode","r","resp","s","t","d","parts","start","moment","matched","confidenceOverlay","series","call","n","v","decodeN","idx","parseInt","shift","channel","increment","keyPrefix","applyConfidence","keys","qpart","tagDefinitions","tagKey","decodePoints","valueOf","values","confidence","decodeConfidencePoints","decodeContinousPoints","push","split","decodeNSection","objToJSON","schema","constructor","j","getOwnPropertyNames","ignore","indexOf","anyToJSON","undefined","toJSON","objFromJSON","json","ref","o","objFromRefedJSON","duration","Serializer","PART_METHODS","AbortablePromise","promise","abort","onFulfilled","onRejected","then","catch","Query","select","beginning","ending","settings","data","decoder","reduce","acc","vpart","cpart","apply","q","url","headers","accept","ajax","request","len","_encodeParts","range","_encodeRange","lastIdx","last","utc","format","inSecs","round","asSeconds","_encodeTime","end","_encodeDuration","vs","_defaultVars","encoded","_updatePart","or","and","equals","notEquals","present","fromJSON"],"mappings":"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"}